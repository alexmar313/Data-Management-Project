---
title: "Crime, Ideology, and Manifestos: A Comparative Study of European Political Trends"
author: "Alex Martinez & Serry Ezbidi"
format:
  html:
    number-sections: true
  pdf:
    number-sections: true
    keep-tex: true
    documentclass: article
    geometry:
      - top=30mm
      - left=20mm
      - right=20mm
      - bottom=30mm
    include-in-header: 
      text: |
        \usepackage{float}
        \usepackage{placeins}
        \usepackage{booktabs}
        \floatplacement{figure}{H}
        \floatplacement{table}{H}
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(
  warning = FALSE,
  message = FALSE 
)
```

```{r, include=FALSE}
here::i_am("Data-Management-Project.Rproj")
library(here)
library(vroom)
library(ggplot2)
library(dplyr)
library(tidyr)
library(stringr)
library(readr)
library(eurostat)
library(lubridate)
library(knitr)
library(tibble)
library(kableExtra)
library(countrycode)
library(tinytex)
library(gridExtra)
library(gridExtra)
library(grid)
```

```{r, include=FALSE}
crime <- get_eurostat("crim_just_ctz", time_format = "num", stringsAsFactors = TRUE)
manifesto <- vroom(("https://manifesto-project.wzb.eu/down/data/2024a/datasets/MPDataset_MPDS2024a.csv"))
ideology <- vroom(("https://eupoliticalbarometer.uc3m.es/api/ideologyDownload"))
pop <- get_eurostat("migr_pop2ctz", time_format = "num", stringsAsFactors = TRUE)
```

# Introduction
## *GitHub Link*
- [GitHub Repository](https://github.com/alexmar313/Data-Management-Project.git)

## *Research question:* 
***What are the associations between immigration and crime suspicions and convictions in the EU, considering political ideology?***

The research explores the relationship between immigration status and crime outcomes (suspicion and conviction rates) in EU countries. It questions whether claims by political entities, particularly right-wing parties, that immigration drives up crime rates hold true, and explores how other intervening factors, such as the demographic profile of immigrants, might contribute to this perception.

## *Background Context and Relevance*
Right-wing political narratives often link immigration with rising crime rates, neglecting broader contextual factors. For instance, statistical evidence shows that most crimes are committed by young males—a demographic disproportionately represented among immigrants.

In the EU, a significant proportion of non-citizens are young males. For example:
- Non-national men aged 20–49 make up 29% of their demographic group, compared to 18% for nationals.
- Additionally, 54–60% of unauthorized immigrants are male, with most under the age of 35.

These demographic realities can skew perceptions of immigrant involvement in crime when not carefully controlled for, contributing to oversimplified populist narratives.
*Source: [Migration 2023](https://ec.europa.eu/eurostat/web/interactive-publications/migration-2023)*

This study integrates crime statistics, demographic data, and measures of political ideology to disentangle these associations. By doing so, it challenges oversimplified narratives and explores whether shifts in political rhetoric influence actual crime outcomes or merely exacerbate perceptions of immigrant criminality.

## *Sub-Questions*
As this study aims to clarify how political discourse influences public perceptions and crime outcomes involving immigrants, three key sub-questions emerge as a guiding framework, among others:
1. Does increased suspicion of immigrant crime correlate with heightened right-wing rhetoric?
2. Do conviction rates, as judicial outcomes, reflect ideological trends, or are they more stable and less influenced by political discourse?

## *Hypotheses*
Preliminary hypotheses indicate that suspicion rates tend to increase in response to ideological, whereas conviction rates remain relatively stable, pointing to potential biases in suspicion rather than outcomes grounded in evidence. By accounting for intervening factors such as demographics, this research underscores the importance of nuanced policy making and seeks to challenge and prevent the perpetuation of harmful stereotypes.

# Empirical Strategy and Data
## *Methodology*
This analysis investigates the relationship between immigration and crime, alongside the sociopolitical factors influencing this dynamic. It begins with a visual exploration of key variables—crime and immigration—examining trends from 2008 to 2022 to identify patterns and contextualize their relationship. Visual representation aims to make the data intuitive and set the stage for further statistical analysis.

Next, regression analyses assess the link between changes in non-citizen percentages and crime outcomes, such as suspicion and conviction rates, while controlling for other factors. These regressions provide statistical insights into whether immigration correlates with significant changes in crime.

The analysis then incorporates broader factors that may shape this relationship, focusing on political polarization, measured by the Dalton Index, and the prevalence of right-wing ideology. Political polarization reflects societal divisions that could influence perceptions of immigration and crime, while right-wing ideology may impact public discourse and policy responses, affecting crime rates or reporting.

Additionally, immigration-related language in political party manifestos during election years is analyzed to understand how rhetoric shapes public perceptions and crime outcomes. This component connects immigration and crime trends to sociopolitical narratives, offering a more comprehensive perspective.

By combining visual analysis, regression models, and exploration of political and ideological contexts, the study seeks nuanced insights into the immigration-crime relationship. Situating this relationship within its broader societal and political framework provides a holistic approach to addressing the research question.

The following data sets were utilized:

## *Eurostat Crime and Criminal Justice Data Set*

### *Download Link*
- [Eurostat Crime Dataset](https://ec.europa.eu/eurostat/databrowser/view/crim_just_ctz/default/table?lang=en)

### *Website Link*
- [Eurostat Crime Website](https://ec.europa.eu/eurostat/databrowser/view/crim_just_ctz/default/table?lang=en)

### *Data Set Description*
The Eurostat Crime and Criminal Justice dataset offers annual statistics on citizens and non-citizens in the justice system across EU member states from 2008 to 2022. It includes suspicion and conviction rates per 1,000 inhabitants, highlighting the number of individuals suspected and convicted of crimes. By differentiating between citizens and non-citizens, the dataset reveals potential disparities in legal treatment, providing essential insights into systemic inequities and the impact of policies on diverse demographics.

### *Description of Variables of Interest*
- *"leg_stat"*: "PER_SUSP" indicates individuals who are suspected of committing crimes, "PER_CNV" indicates individuals who are convicted of crimes.
- *"citizen"*: "NAT" indicates nationals (citizens of the reporting country), "FOR" represents foreigners (non-citizens).

## *Eurostat Population Data Set*

### *Download Link*
- [Eurostat Population Dataset](https://ec.europa.eu/eurostat/databrowser/view/migr_pop2ctz/default/table?lang=en&category=demo.demo_pop)

### *Website Link*
- [Eurostat Population Website](https://ec.europa.eu/eurostat/api/dissemination/sdmx/2.1/data/migr_pop2ctz?format=TSV&compressed=true)

### *Data Set Description*
The Eurostat Crime dataset provides annual data on suspicion and conviction numbers, disaggregated by citizenship (citizens vs. non-citizens), for 2008–2022. Combined with population statistics, it enables the calculation of suspicion and conviction rates as proportions of each group's population, allowing for trend analysis to uncover disparities.

The Eurostat Population dataset offers yearly data on the population of citizens and non-citizens, including foreigners and stateless individuals, across EU member states over the same period. It provides critical insights into demographic compositions and supports the calculation of suspicion and conviction rates as percentages, facilitating a deeper understanding of disparities between these groups.

### *Description of Variables of Interest*
- *"citizen"*: "FOR_STLS" indicates individuals who are foreigners or stateless, "NAT" indicates individuals who are citizens to the country.
- *"other demographic variables"*: the variables *age* and *sex* allow us if wished to assess how more specific trends, for instance we could observ whether changes in results occur if we consider only men.

## *Manifesto Project Data set*

### *Download Link*
- [Manifesto Dataset](https://manifesto-project.wzb.eu/down/data/2024a/datasets/MPDataset_MPDS2024a.csv)

### *Website Link*
- [Manifesto Website](https://manifesto-project.wzb.eu/datasets)

### *Data Set Description*
The Manifesto Project dataset provides a systematic analysis of political party manifestos from various countries, including EU member states, covering elections from 1946 to 2017 (with country-specific coverage). It tracks the percentage of text dedicated to key themes like "law and order," "national security," and "national values." This dataset is valuable for studying the evolution of political discourse, with its quantifiable measures offering insights into how party platforms shape public opinion and influence policy. Its historical scope allows for longitudinal studies of political ideologies and their impact on governance trends.

### *Description of Variables of Interest*
- *"per101 to per109"*: represent the percentage of the political party's manifesto dedicated to specific themes related to national security, crime, and immigration. They focus on topics like law and order, national security, crime prevention, and the role of the state in dealing with security threats. Specifically: per101: Law and Order, per102: National Security, per103: Crime and Punishment, per104: Prison and Penal System, per105: Immigration, per106: International Relations (related to security), per107: Economic Issues, per108: Welfare and Social Issues, per109: Cultural and National Identity
- *"per201 to per204"*: focus on economic policies, social support, and public services, potentially linking to discussions about immigration’s impact on the economy and social welfare. Specifically, per201: Economic Growth, per202: Employment, per203: Social Security, per204: Public Services
- *"per301 to per305"*: focus on social welfare, social issues, and public goods, which might also intersect with debates around immigration and crime in relation to societal well being and state responsibility. Specifically, per301: Social Welfare, per302: Education, per303: Health Care, per304: Family Support, per305: Environment and Sustainability.

## *EU Political Barometer Data set*

### *Download Link*
- [Ideology Dataset](https://eupoliticalbarometer.uc3m.es/api/ideologyDownload)

### *Website Link*
- [EU Political Barometer Dashboard](https://eupoliticalbarometer.uc3m.es/dashboard/ideology)

### *Data Set Description*
The EU Political Barometer dataset provides bi-monthly data on public opinion and political preferences across EU member states from 2019 to 2023. It tracks shifts in ideology, political attitudes, and public reactions to major events and campaigns. Key indicators include changes in support for various ideologies and parties, offering a detailed view of evolving public sentiment. This dataset is valuable for analyzing short-term trends and the relationship between political discourse and public opinion. Its frequent updates make it an essential resource for real-time political analysis and policy evaluation.

### *Description of Variables of Interest*
- *"left_ideology"*: numeric score (0-10) representing the left-wing ideological positioning in the country, where a higher value corresponds to stronger left ideology.
- *"right_ideology"*: numeric score (0-10) representing the right-wing ideological positioning in the country, where a higher value corresponds to stronger right ideology.
- *"dalton"*: named after the political scientist Russell Dalton, a numeric score (0-10) that shows the degree of ideological polarization in a country, where a higher score corresponds to higher polarization.


## *Description Table*
```{r, echo=FALSE}
get_summary <- function(data, name, year_column, date_format, country_column) {

  years <- tryCatch({
    if (date_format == "year") {
      data[[year_column]]
    } else if (date_format == "year-month-day") {
      year(as.Date(data[[year_column]]))
    } else if (date_format == "day/month/year") {
      year(dmy(data[[year_column]]))
    } else {
      NA
    }
  }, error = function(e) NA)

  if (all(is.na(years))) {
    years_covered <- "Invalid Year Column"
  } else {
    years_covered <- paste(range(years, na.rm = TRUE), collapse = " - ")
  }
  
  num_countries <- if (country_column %in% names(data)) {
    length(unique(data[[country_column]]))
  } else {
    0
  }
  
  tibble(
    Dataset = name,
    Rows = nrow(data),
    Columns = ncol(data),
    `Years Covered` = years_covered,
    `Number of Countries` = num_countries,
    `Total Datapoints` = nrow(data) * ncol(data)
  )
}

datasets <- list(
  list(name = "Crime Dataset", data = crime, year_column = "TIME_PERIOD", date_format = "year", country_column = "geo"),
  list(name = "Ideology Dataset", data = ideology, year_column = "date", date_format = "year-month-day", country_column = "country_name"),
  list(name = "Manifesto Dataset", data = manifesto, year_column = "edate", date_format = "year-month-day", country_column = "countryname"),
  list(name = "Population Dataset", data = pop, year_column = "TIME_PERIOD", date_format = "year", country_column = "geo")
)

summaries <- lapply(datasets, function(ds) {
  get_summary(ds$data, ds$name, ds$year_column, ds$date_format, ds$country_column)
})

summary_table <- bind_rows(summaries) 
knitr::kable(summary_table)

```

# Data Cleaning Process
This section details the data cleaning and integration process undertaken to prepare four distinct data sets for analysis. Each data set varied in terms of years, countries, and data frequencies, posing challenges such as inconsistent time periods, differing country classifications, and variations in granularity. The process involved standardizing formats, ensuring compatibility across sources, and removing irrelevant variables. 

Data joining steps were then performed to merge the sources into a unified data set, requiring tables to be pivoted and reshaped for alignment by year and country. This thorough preparation was crucial to ensure reliable and consistent findings, enabling a robust exploration of the relationships between immigration, crime, and political ideology.

## *Cleaning of Eurostat Data, Crime*
```{r, include=FALSE}
crime <- crime %>%
  filter(citizen != "TOTAL" & leg_stat != "PER_PRSC" & unit != "P_HTHAB")
```
- *Filtering and cleaning:* remove irrelevant categories (e.g., "TOTAL" citizens and "PER_PRSC" status), keeping only the data as total number of citizens and non-citizens suspicted and convicted to crimes.
```{r, include=FALSE}
crime <- crime %>%
  mutate(geo = countrycode(geo, origin = "iso2c", destination = "country.name"))
crime <- crime %>%
  filter(!is.na(geo))
```
- *Country name assignment:* convert country codes to full country names using the "countrycode" package.
```{r, include=FALSE}
crime <- crime %>%
  mutate(Category = case_when(
    citizen == "NAT" & leg_stat == "PER_CNV" ~ "Convicted Citizens",
    citizen == "FOR" & leg_stat == "PER_CNV" ~ "Convicted Non-Citizens",
    citizen == "NAT" & leg_stat == "PER_SUSP" ~ "Suspected Citizens",
    citizen == "FOR" & leg_stat == "PER_SUSP" ~ "Suspected Non-Citizens",
    TRUE ~ NA_character_  
  ))
```
- *Category creation:* classify data into four categories based on citizenship and legal status: "Convicted Citizens," "Convicted Non-Citizens," "Suspected Citizens," and "Suspected Non-Citizens."
```{r, include=FALSE}
crime <- crime %>%
  select(geo, TIME_PERIOD, Category, values)
crime <- crime %>%
  rename(
    year = TIME_PERIOD,
    country = geo
  )
```
- *Drop irrelevant variables:* rename and include only variables of interest: country, date, citizenship & legal status category, and crime rates.
```{r, include=FALSE}
crime <- crime %>%
  pivot_wider(
    names_from = Category,
    values_from = values    
  )
```
- *Data reshaping:* pivot the data to have a single row per country per year, with columns for each of the four categories (convicted and suspected citizens/non-citizens).

## *Cleaning of Eurostat Data, Population*
```{r, include=FALSE}
Tpop <- pop %>%
  filter(age == "TOTAL", sex == "T", citizen != "UNK", citizen != "TOTAL") %>%
  rename(year = TIME_PERIOD) 
```
- *Filtering and cleaning:* remove irrelevant category (e.g. "UNK" or "TOTAL" citizens), keeping only the data as total numbers. Creating a new data set in which we do not separate per sex or age.
```{r, include=FALSE}
Tpop <- Tpop %>%
  filter(year >= 2008)
```
- *Date filtering:* remove data before 2008 (the first available year in the Crime data set).
```{r, include=FALSE}
Tpop <- Tpop %>%
  mutate(country = countrycode(geo, origin = "iso2c", destination = "country.name", warn = FALSE)) %>%
  filter(!is.na(country)) 
```
- *Country name assignment:* convert country codes to full country names using the "countrycode" package.
```{r, include=FALSE}
Tpop <- Tpop %>%
  group_by(country, year, citizen) %>%
  summarise(
    population = sum(values, na.rm = TRUE),
    .groups = "drop"
  )
```
- *Summarize the data:* group the data by country, year, and citizen and calculate the total population for each group.
```{r, include=FALSE}
Tpop <- Tpop %>%
  pivot_wider(
    names_from = citizen,
    values_from = population,
    values_fill = 0
  ) %>%
  mutate(
    population_citizens = NAT,
    population_non_citizens = FOR_STLS,
    population_total = NAT + FOR_STLS
  )
```
- *Reshape Data for Citizens and Non-Citizens:* Reshapes the data to separate populations of citizens (NAT) and non-citizens (FOR_STLS).

## *Cleaning of Manifesto Data, Manifesto*
```{r, include=FALSE}
manifesto <- manifesto %>%
  mutate(edate = dmy(edate)) %>%
  filter(edate >= as.Date("2008-01-01"))
```
- *Date filtering:* remove data before 2008 (the first available year in the Crime dataset).
```{r, include=FALSE}
manifesto <- manifesto %>%
  select(countryname, partyname, edate, per101, per102, per103, per104, per105, per106, per107, per108, per109, per201, per203, per202, per204, per301, per302, per303, per304, per305)
```
- *Column selection:* Keeps only relevant columns in the manifesto dataset (e.g., political themes related to law and order, national security, immigration).
```{r, include=FALSE}
manifesto <- manifesto %>%
  mutate(date = year(edate)) 

manifesto <- manifesto %>%
  select(countryname, date, per101, per102, per103, per104, per105, per106, per107, per108, per109, per201, per203, per202, per204, per301, per302, per303, per304, per305)

manifesto <- manifesto %>%
  group_by(countryname, date) %>%
  summarise(
    per101 = mean(per101, na.rm = TRUE),
    per102 = mean(per102, na.rm = TRUE),
    per103 = mean(per103, na.rm = TRUE),
    per104 = mean(per104, na.rm = TRUE),
    per105 = mean(per105, na.rm = TRUE),
    per106 = mean(per106, na.rm = TRUE),
    per107 = mean(per107, na.rm = TRUE),
    per108 = mean(per108, na.rm = TRUE),
    per109 = mean(per109, na.rm = TRUE),
    per201 = mean(per201, na.rm = TRUE),
    per202 = mean(per202, na.rm = TRUE),
    per203 = mean(per203, na.rm = TRUE),
    per204 = mean(per204, na.rm = TRUE),
    per301 = mean(per301, na.rm = TRUE),
    per302 = mean(per302, na.rm = TRUE),
    per303 = mean(per303, na.rm = TRUE),
    per304 = mean(per304, na.rm = TRUE),
    per305 = mean(per305, na.rm = TRUE)
  ) %>%
  ungroup()

manifesto <- manifesto %>%
  rename(year = date,
         country = countryname)
```
- *Group by date and country:* extract the year from the date and group the data by country and year to compute the average percentage of the manifesto dedicated to specific themes like law and order, national security, and immigration.

## *Cleaning of Barometer Data, Ideology*
```{r, include=FALSE}
ideology <- ideology %>%
  filter(data_type != "ewma")
```
- *Filter invalid data:* removes data related to "ewma" (exponentially weighted moving average) and retain only real ideological scores.
```{r, include=FALSE}
ideology <- ideology %>%
  filter(date < as.Date("2023-01-01"))
```
- *Date filtering:* filter the data set to include only data up until 2023.
```{r, include=FALSE}
ideology <- ideology %>%
  mutate(year = year(date))

ideology <- ideology %>%
  group_by(country_name, year) %>%
  summarise(
    left_ideology = mean(left_ideology, na.rm = TRUE),
    right_ideology = mean(right_ideology, na.rm = TRUE),
    dalton = mean(dalton, na.rm = TRUE)
  ) %>%
  ungroup()

ideology <- ideology %>%
  rename(country = country_name)
```
- *Ideology Data:* extract the year from the date and groups the data by country and year to calculate the average ideological scores (left, right, and Dalton's polarization index).

## *Joint Cleaning*
```{r, include=FALSE}
crime <- crime %>%
  semi_join(Tpop, by = c("country" = "country"))
Tpop <- Tpop %>%
  semi_join(crime, by = c("country" = "country"))
ideology <- ideology %>%
  semi_join(crime, by = c("country" = "country"))
manifesto <- manifesto %>%
  semi_join(crime, by = c("country" = "country"))
```
- *Data intersection:* ensure that only countries present in the Crime and Population are kept in the Manifesto and Ideology data sets. This is achieved through a semi_join to keep only the common countries.

## *Merging of Data Sets*
```{r, include=FALSE}
crime$year <- as.numeric(crime$year)
manifesto$year <- as.numeric(manifesto$year)
ideology$year <- as.numeric(ideology$year)

merged_data <- full_join(crime, manifesto, by = c("country", "year")) %>%
  full_join(ideology, by = c("country", "year"))
```
- *Merge Crime, Manifesto and Ideology*: previously renamed columns in all three data sets for consistency and merge them into one unified data set. "full_join" is used to ensure no data is lost while combining them based on country and year.
```{r, include=FALSE}
merged_data <- Tpop %>%
  inner_join(merged_data, by = c("country", "year"))
merged_data <- merged_data %>%
  mutate(
    convicted_p_c = (`Convicted Citizens` / `population_citizens`) * 100,
    convicted_p_nc = (`Convicted Non-Citizens` / `population_non_citizens`) * 100,
    suspected_p_c = (`Suspected Citizens` / `population_citizens`) * 100,
    suspected_p_nc = (`Suspected Non-Citizens` / `population_non_citizens`) * 100
  )
```
- *Merge also with Population Data:* add the fourth data set. It would be informative to present the data as percentages in addition to raw numbers. For example, we can display the proportion of suspected non-citizens relative to the total population of non-citizens, and compare this to the proportion of suspected citizens relative to the total population of citizens. We hence also calculate percentages for convictions and suspicions for both citizens and non-citizens

# Results

## *Trends in the Percentage of Non-Citizens Over Time*
```{r, include=FALSE}
## THIS IS JUST TO FIND THAT THE AVERAGE GROWTH RATE PER YEAR OF THE SHARE OF NON-CITIZENS IS 4.47% PER YEAR OVER ALL COUNTRIES ##
merged_data <- merged_data %>%
  mutate(share_non_citizens = population_non_citizens / population_total)

merged_data <- merged_data %>%
  group_by(country) %>%
  arrange(year) %>% 
  mutate(growth_rate = (share_non_citizens - lag(share_non_citizens)) / lag(share_non_citizens)) %>%
  ungroup() 

overall_average_growth_rate <- merged_data %>%
  summarize(avg_growth_rate = mean(growth_rate, na.rm = TRUE))

overall_average_growth_rate
```
Figure 1 shows a steady increase in the proportion of non-citizens across all countries from 2008 to 2022, with a dip around 2013–2014 and consistent growth afterward. By 2022, the average percentage of non-citizens exceeds 11%. The data also reveals an average yearly increase of 4.47% in the number of non-citizens, reflecting broader demographic shifts tied to increased migration flows in Europe.

Figure 4 breaks this down by country, focusing on Austria, Germany, France, and Bulgaria. Austria shows the most significant growth, with non-citizens reaching nearly 17% of the population by 2022. Germany also sees steady growth, rising to around 13%. France follows a more moderate upward trend, while Bulgaria diverges, with a declining percentage of non-citizens after 2020. These trends reflect how national migration policies, economic factors, and societal attitudes shape demographic dynamics.

By comparing country-specific trends to overall averages, Figure 4 underscores Austria and Germany's leadership in non-citizen population growth, while Bulgaria presents a distinct demographic pattern.

## *Trends in Crime Suspicion and Conviction*
Figure 3 shows that non-citizens are consistently suspected of crimes at higher rates than citizens. Suspicion rates for non-citizens spike sharply in 2014, peaking above 7.5%, before stabilizing in later years. In contrast, citizen suspicion rates remain steady, averaging between 0% and 1%. These trends highlight systemic differences, with non-citizens facing significantly higher suspicion rates in criminal contexts.

Figure 2, which tracks conviction rates over time, does not show a similar spike in 2014 but confirms the disparity between citizens and non-citizens. Non-citizen conviction rates decline steadily, from about 3% in 2008–2014 to around 1.5% by 2020. Citizen conviction rates, starting near 1%, decrease steadily to nearly zero by 2022. This divergence underscores that non-citizens consistently face higher conviction rates, despite declining trends for both groups over time.

## *Relationship Between Immigration and Crime*
The analysis of immigration and crime provides nuanced insights into the dynamics of suspicion and conviction rates among non-citizens.

Figure 7 examines the percentage of non-citizens in the population against total convictions. The scatter plot and regression line reveal no strong correlation, challenging the narrative that higher proportions of non-citizens drive crime. This suggests total convictions are not inherently linked to immigration.

Similarly, Figure 8 analyzes the relationship between the percentage of non-citizens and total suspicions, finding no significant association. This further refutes simplistic arguments linking immigration to overall crime levels, as suspicion rates do not increase proportionally with the share of non-citizens.

In contrast, Figure 9 focuses on suspicion rates for non-citizens relative to their population and shows a clear positive relationship. As the percentage of non-citizens rises, suspicion rates for this group also increase, suggesting heightened scrutiny, possibly reflecting systemic biases or societal perceptions.

Figure 10 extends this analysis to conviction rates for non-citizens. While a positive correlation exists, it is weaker than for suspicion rates. This disparity highlights that while non-citizens face heightened suspicion, the conviction process appears to incorporate additional checks that mitigate this trend. Together, these findings underscore a gap between suspicion and judicial outcomes, pointing to systemic or societal biases disproportionately affecting non-citizens at the suspicion stage.

## *Impact of Political and Ideological Factors*
This study examines the impact of political polarization and ideology on crime outcomes, shedding light on how societal divides influence perceptions and judicial processes.

Figure 11 explores the relationship between political polarization, measured by the Dalton Index, and total convictions. A weak positive association suggests that societal divisions have a modest influence on overall crime outcomes, with a more pronounced effect on non-citizen-specific outcomes.

Figure 12 shows a weak positive correlation between polarization and conviction rates for non-citizens, indicating a marginal impact on judicial outcomes. In contrast, Figure 13 highlights a significantly stronger positive relationship between polarization and suspicion rates for non-citizens. This suggests that higher polarization fosters biased perceptions of immigrant crime, leading to increased suspicion rates.

The influence of right-wing ideology reveals similar patterns. Figure 14 shows a weak positive correlation between right-wing ideology and total convictions, indicating limited influence on broader judicial outcomes. However, non-citizen-specific trends provide more insight.

Figure 15 shows minimal variation in conviction rates for non-citizens with shifts in right-wing ideology, suggesting that judicial processes are relatively insulated from political discourse. Conversely, Figure 16 reveals a strong positive relationship between right-wing ideology and suspicion rates for non-citizens. As right-wing dominance grows, suspicion rates for non-citizens increase, emphasizing the critical role of political rhetoric in shaping public and institutional attitudes toward immigrants.

# Discussion
This study explored the relationships between immigration, crime outcomes, and political ideology in the EU, offering nuanced insights into these dynamics.

The data show non-citizens are disproportionately suspected and convicted of crimes compared to citizens. However, these trends are largely explained by demographic factors, such as the overrepresentation of young males among immigrant populations, rather than immigration itself driving higher crime rates.

Total convictions and suspicions show weak associations with the percentage of non-citizens, challenging populist claims of a direct link between immigration and crime.

Suspicion rates for non-citizens are more responsive to political and ideological shifts, with stronger right-wing ideologies and higher polarization correlating with increased suspicion. This suggests political rhetoric significantly influences public and institutional responses to immigration. In contrast, conviction rates appear less affected by ideological factors, indicating the judicial process may be more insulated from political discourse.

The gap between higher suspicion rates and stable conviction rates for non-citizens points to potential biases in the criminal justice system, highlighting issues of unequal treatment.

These findings confirm the hypothesis: suspicion rates rise with ideological shifts, while conviction rates remain stable. They challenge simplistic narratives linking immigration to crime and emphasize the need to address demographic and systemic factors for more equitable policymaking.

# Conclusion and recommendation
This study examined the complex relationships between immigration, crime outcomes, and political ideology in EU member states from 2008 to 2022, providing nuanced insights into these dynamics.

Data show consistently higher suspicion rates among non-citizens compared to citizens, with a smaller disparity in conviction rates. However, these trends require cautious interpretation due to underlying demographic factors and unmeasured social dynamics.

Total convictions and suspicions exhibit weak or no strong association with the percentage of non-citizens in the population, challenging simplistic narratives linking immigration to higher overall crime rates. Suspicion rates for non-citizens appear more sensitive to political and ideological shifts, as suggested by analysis of manifesto data and the Dalton Index. However, endogeneity concerns, such as reverse causality where crime influences political rhetoric, limit causal conclusions. Conviction rates, while showing disparities, seem less directly influenced by political factors, suggesting the judicial process may be somewhat insulated from such influences.

The gap between higher suspicion rates and less pronounced conviction disparities among non-citizens points to potential biases in the criminal justice system, warranting further investigation into systemic inequalities. 

Limitations such as sample size, cross-national differences in crime definitions, and endogeneity issues necessitate cautious interpretation. Future research should employ advanced econometric methods and natural experiments to strengthen causal inferences. Despite these limitations, the findings offer valuable insights into the interplay of immigration, crime, and political ideology, emphasizing the importance of evidence-based policymaking.

# Appendix

```{r, echo=FALSE, fig.pos="H"}
merged_data <- merged_data %>%
  mutate(percent_non_citizens = (population_non_citizens / population_total) * 100)

average_non_citizens <- merged_data %>%
  group_by(year) %>%
  summarize(avg_percent_non_citizens = mean(percent_non_citizens, na.rm = TRUE))

ggplot(average_non_citizens, aes(x = year, y = avg_percent_non_citizens)) +
  geom_line(color = "blue", size = 1) +
  geom_point(color = "blue", size = 2) +
  labs(
    title = "Average Percentage of Non-Citizens Across All Countries",
    x = "Year",
    y = "Average Percentage of Non-Citizens"
  ) +
  theme_minimal()

```
Figure 1: ***Percentage of Non-Citizens Over Time***

*Note*: This graph tracks the proportion of non-citizens in the population over time for selected countries. It shows a steady increase in most countries, with Austria leading in growth, reaching 17% by 2022. Bulgaria diverges with a declining trend, reflecting differing demographic dynamics.

```{r, echo=FALSE, fig.pos="H"}
merged_data %>%
  group_by(year) %>%
  summarise(
    avg_citizens = mean(convicted_p_c, na.rm = TRUE),
    avg_non_citizens = mean(convicted_p_nc, na.rm = TRUE)
  ) %>%
  pivot_longer(
    cols = c(avg_citizens, avg_non_citizens),
    names_to = "group",
    values_to = "value_percentage"
  ) %>%
  mutate(group = ifelse(group == "avg_citizens", "Citizens", "Non-Citizens")) %>%
  ggplot(aes(x = year, y = value_percentage, color = group, linetype = group)) +
  geom_line(size = 1.2) +
  labs(
    title = "Average Percentage of Convicted Citizens and Non-Citizens",
    x = "Year",
    y = "Average Percentage",
    color = "Group",
    linetype = "Group"
  ) +
  theme_minimal()+
  theme(
    legend.position = "bottom"  # Moves the legend below the graph
  ) +
  scale_color_manual(
    values = c(
      "Non-Citizens" = "red", 
      "Citizens" = "orange"
    )
  )
```
Figure 2: ***Crime Conviction Over Time***

*Note*: This graph illustrates the number of individuals convicted of crimes, separated by citizenship status. Non-citizens exhibit higher conviction rates compared to citizens, with non-citizen conviction rates declining steadily from 2008 to 2020. Citizen conviction rates start at around 1% and approach zero by 2022, indicating a systemic disparity in convictions.

```{r, echo=FALSE, fig.pos="H"}
merged_data %>%
  group_by(year) %>%
  summarise(
    avg_citizens = mean(suspected_p_c, na.rm = TRUE),
    avg_non_citizens = mean(suspected_p_nc, na.rm = TRUE)
  ) %>%
  pivot_longer(
    cols = c(avg_citizens, avg_non_citizens),
    names_to = "group",
    values_to = "value_percentage"
  ) %>%
  mutate(group = ifelse(group == "avg_citizens", "Citizens", "Non-Citizens")) %>%
  ggplot(aes(x = year, y = value_percentage, color = group, linetype = group)) +
  geom_line(size = 1.2) +
  labs(
    title = "Average Percentage of Suspected Citizens and Non-Citizens",
    x = "Year",
    y = "Average Percentage",
    color = "Group",
    linetype = "Group"
  ) +
  theme_minimal()+
  theme(
    legend.position = "bottom"  # Moves the legend below the graph
  ) +
  scale_color_manual(
    values = c(
      "Non-Citizens" = "red", 
      "Citizens" = "orange"
    )
  )
```
Figure 3: ***Crime Suspicion Over Time***

*Note:* This graph shows the number of individuals suspected of crimes, dis-aggregated by citizenship status (citizens vs. non-citizens) from 2008 to 2022. It highlights a significant disparity, with non-citizens consistently suspected at higher rates than citizens. Key trends include a notable spike in non-citizen suspicion rates in 2014, while citizen suspicion rates remain relatively stable, averaging 0-1%.

```{r, echo=FALSE, fig.pos="H"}
filtered_data <- merged_data %>%
  filter(country %in% c("France", "Germany", "Austria", "Bulgaria"))

ggplot(filtered_data, aes(x = year)) +
  geom_line(aes(y = (FOR_STLS/population_total)*100, color = "Percentage of Non-Citizens"), linewidth = 1) +
  facet_wrap(~country, scales = "free_y") +  # Split by country
  labs(
    title = "Percentage of Non-Citizens Over Time",
    x = "Year",
    y = "Percentage of People",
    color = "Category"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom"  # Move the legend below the graph
  ) +
  scale_color_manual(
    values = c(
      "Percentage of Non-Citizens" = "red" 
    )
  )
```
Figure 4: ***Percentage of Non-Citizens in Selected Countries Over Time***

*Note:* This graph shows the percentage of non-citizens relative to the total population in four selected countries (France, Germany, Austria, and Bulgaria) from 2008 to 2022. The trends are visualized individually for each country, with the y-axis scaled independently to accommodate country-specific variations. Key insights include a steady increase in the percentage of non-citizens in most countries, with Austria showing the most significant growth, while Bulgaria exhibits a declining trend. This graph highlights demographic shifts in the proportion of non-citizens, offering critical context for understanding crime-related data.


```{r, echo=FALSE, fig.pos="H"}
ggplot(filtered_data, aes(x = year)) +
  geom_line(aes(y = `Convicted Non-Citizens`, color = "Convicted Non-Citizens"), linewidth = 1) +
  geom_line(aes(y = `Convicted Citizens`, color = "Convicted Citizens"), linewidth = 1) +
  facet_wrap(~country, scales = "free_y") +  # Split by country
  labs(
    title = "Crime Conviction Over Time",
    x = "Year",
    y = "Number of People",
    color = "Category"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom"
  ) +
  scale_color_manual(
    values = c(
      "Convicted Non-Citizens" = "red", 
      "Convicted Citizens" = "orange"
    )
  )
```
Figure 5: ***Crime Convictions Over Time by Citizenship Status***

*Note:* This graph illustrates the trends in crime convictions for both non-citizens and citizens over time in selected countries. The data is dis-aggregated by country, with each country shown in a separate facet, and the y-axis scaled independently for better visualization of country-specific patterns. The red line represents convictions of non-citizens, while the orange line represents convictions of citizens.


```{r, echo=FALSE, fig.pos="H"}
ggplot(filtered_data, aes(x = year)) +
  geom_line(aes(y = `Suspected Non-Citizens`, color = "Suspected Non-Citizens"), linewidth = 1) +
  geom_line(aes(y = `Suspected Citizens`, color = "Suspected Citizens"), linewidth = 1) +
  facet_wrap(~country, scales = "free_y") + 
  labs(
    title = "Crime Suspicion Over Time",
    x = "Year",
    y = "Number of People",
    color = "Category"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom"  
  ) +
  scale_color_manual(
    values = c(
      "Suspected Non-Citizens" = "red", 
      "Suspected Citizens" = "orange"
    )
  )
```
Figure 6: ***Crime Suspicions Over Time by Citizenship Status***

*Note:* This graph illustrates the trends in crime suspicions for both non-citizens and citizens over time in selected countries. The data is dis-aggregated by country, with each country shown in a separate facet, and the y-axis scaled independently for better visualization of country-specific patterns. The red line represents convictions of non-citizens, while the orange line represents convictions of citizens.


```{r, echo=FALSE, fig.pos="H"}

countries <- c("France", "Germany", "Austria", "Bulgaria")

for(curr_country in countries) {
  
  p1 <- filtered_data %>%
    filter(country == curr_country) %>% 
    group_by(year) %>%
    summarise(
      convicted = mean(convicted_p_c, na.rm = TRUE),
      suspected = mean(suspected_p_c, na.rm = TRUE)
    ) %>%
    pivot_longer(
      cols = c(convicted, suspected),
      names_to = "type",
      values_to = "percentage"
    ) %>%
    mutate(type = tools::toTitleCase(type)) %>%
    ggplot(aes(x = year, y = percentage, color = type, linetype = type)) +
    geom_line(linewidth = 1.2) +
    labs(
      title = paste(curr_country, "- Citizens"),
      x = "Year",
      y = "Percentage",
      color = "Type",
      linetype = "Type"
    ) +
    theme_minimal() +
    theme(legend.position = "bottom")
  
  p2 <- filtered_data %>%
    filter(country == curr_country) %>%  # Use the loop variable 'curr_country'
    group_by(year) %>%
    summarise(
      convicted = mean(convicted_p_nc, na.rm = TRUE),
      suspected = mean(suspected_p_nc, na.rm = TRUE)
    ) %>%
    pivot_longer(
      cols = c(convicted, suspected),
      names_to = "type",
      values_to = "percentage"
    ) %>%
    mutate(type = tools::toTitleCase(type)) %>%
    ggplot(aes(x = year, y = percentage, color = type, linetype = type)) +
    geom_line(linewidth = 1.2) +
    labs(
      title = paste(curr_country, "- Non-Citizens"),
      x = "Year",
      y = "Percentage",
      color = "Type",
      linetype = "Type"
    ) +
    theme_minimal() + 
    theme(legend.position = "bottom")
  
  grid.arrange(
    p1, p2, 
    ncol = 2, 
    top = paste("Convicted vs Suspected as Percentages for", curr_country)
  )
}

```
Figure 6: ***Convicted vs. Suspected Percentages Over Time for Citizens and Non-Citizens***

*Note*: This series of graphs displays the trends in conviction and suspicion rates as percentages of the respective populations (citizens and non-citizens) for four selected countries: France, Germany, Austria, and Bulgaria. Each country is presented in a separate panel with two subplots.
Citizens (Left Panel): Shows the average conviction and suspicion rates for citizens over time.
Non-Citizens (Right Panel): Depicts the average conviction and suspicion rates for non-citizens over time. The Y-axis represents the percentage of each group (citizens or non-citizens) suspected or convicted of crimes.


```{r, echo=FALSE, fig.pos="H"}
merged_data_final <- merged_data %>%
  mutate(
    total_convicted = `Convicted Citizens` + `Convicted Non-Citizens`,
    total_suspected = `Suspected Citizens` + `Suspected Non-Citizens`,
    percentage_nc_pop = (population_non_citizens / (population_non_citizens + population_citizens)) * 100
  )

convicted_analysis_data <- merged_data_final %>%
  select(country, year, percentage_nc_pop, total_convicted)

ggplot(convicted_analysis_data, aes(x = percentage_nc_pop, y = total_convicted, color = country)) +
  geom_point() +
  geom_smooth(method = "lm", formula = y ~ x, se = FALSE, color = "black", linetype = "dashed") +
  labs(
    title = "Relationship between the Percentage of Non-Citizens and Total Conviction",
    x = "Percentage of Non-Citizens in Total Population",
    y = "Total Convictions"
  ) +
  theme_minimal() +
  theme(
    legend.position = "none"
  )
```
Figure 7: ***Relationship between the Percentage of Migrants and Total Convictions***

*Note:* This scatter plot shows the relationship between the percentage of non-citizens in the total population and the total number of convictions across countries. Each point represents a country in a given year. The dashed black line represents the linear regression model fit, showing a weak correlation between the variables, suggesting that total convictions are not strongly driven by the percentage of non-citizens.


```{r, echo=FALSE, results='asis'}
model_convicted <- lm(total_convicted ~ percentage_nc_pop, 
                     data = merged_data_final)

Conviction_Model <- data.frame(
  Term = c("Intercept", "% Non-Citizens"),
  Estimate = coef(model_convicted),
  `Std.Error` = summary(model_convicted)$coefficients[,2],
  `t.value` = summary(model_convicted)$coefficients[,3],
  `p.value` = summary(model_convicted)$coefficients[,4]
) %>%
  kbl(caption = "Regression Results: Total Convicted Persons",
      digits = 3) %>%
  kable_styling(bootstrap_options = c("striped", "hover"))

Conviction_Model
```
Table 1: ***Regression Results for Total Convictions (Percentage of Non-Citizens)***

*Note:* This table provides the regression results for the relationship between total convictions and the percentage of non-citizens. The coefficients represent the estimated effects, with standard errors, t-values, and p-values provided to assess statistical significance.


```{r, echo=FALSE, fig.pos="H"}
suspected_analysis_data <- merged_data_final %>%
  select(country, year, percentage_nc_pop, total_suspected)

ggplot(suspected_analysis_data, aes(x = percentage_nc_pop, y = total_suspected, color = country)) +
  geom_point() +
  geom_smooth(method = "lm", formula = y ~ x, se = FALSE, color = "black", linetype = "dashed") +
  labs(
    title = "Relationship between the Percentage of Non-Citizens and Total Suspicions",
    x = "Percentage of Non-Citizens in Total Population",
    y = "Total Suspicions"
  ) +
  theme_minimal()+
  theme(
    legend.position = "none"
  )
```
Figure 8: ***Relationship between the Percentage of Migrants and Total Suspicions***

*Note:* This scatter plot illustrates the relationship between the percentage of non-citizens in the total population and the total number of suspicions. Similar to convictions, the linear regression model (dashed black line) indicates a weak association, with no strong evidence that the proportion of non-citizens drives suspicion numbers.


```{r, echo=FALSE, results='asis'}
model_suspected <- lm(total_suspected ~ percentage_nc_pop, 
                     data = merged_data_final)

Supspicion_Model <- data.frame(
  Term = c("Intercept", "% Non-Citizens"),
  Estimate = coef(model_suspected),
  `Std.Error` = summary(model_suspected)$coefficients[,2],
  `t.value` = summary(model_suspected)$coefficients[,3],
  `p.value` = summary(model_suspected)$coefficients[,4]
) %>%
  kbl(caption = "Regression Results: Total Suspected Persons",
      digits = 3) %>%
  kable_styling(bootstrap_options = c("striped", "hover"))

Supspicion_Model

```
Table 2: ***Regression Results for Total Suspicions (Percentage of Non-Citizens)***

*Note:* This table summarizes the regression results for the relationship between total suspicions and the percentage of non-citizens. The provided metrics help evaluate the strength and significance of this relationship.


```{r, echo=FALSE, fig.pos="H"}
suspected_analysis_data <- merged_data_final %>%
  filter(country != "Bulgaria") %>% 
  select(country, year, percentage_nc_pop, suspected_p_nc)

ggplot(suspected_analysis_data, aes(x = percentage_nc_pop, y = suspected_p_nc, color = country)) +
  geom_point() +
  geom_smooth(method = "lm", formula = y ~ x, se = FALSE, color = "black", linetype = "dashed") +
  labs(
    title = "Relationship between the Percentage of Migrants and Suspicions of Non-citizens",
    x = "Percentage of Non-Citizens in Total Population",
    y = "Percentage of Non-citizens Suspected"
  ) +
  theme_minimal()+
  theme(
    legend.position = "none"
  )
```
Figure 9: ***Relationship between the Percentage of Migrants and Suspicion Rates for Non-Citizens***

*Note:* This scatter plot focuses on the percentage of non-citizens suspected of crimes relative to the non-citizen population. Bulgaria was removed as an outlier. The linear regression line shows a positive association, indicating that as the percentage of non-citizens in the population increases, suspicion rates for non-citizens also rise.


```{r, echo=FALSE, results='asis'}
model_suspected_nc <- lm(suspected_p_nc ~ percentage_nc_pop, 
                     data = merged_data_final  %>% filter(country != "Bulgaria"))

Supspicion_Model_nc <- data.frame(
  Term = c("Intercept", "% Non-Citizens"),
  Estimate = coef(model_suspected),
  `Std.Error` = summary(model_suspected)$coefficients[,2],
  `t.value` = summary(model_suspected)$coefficients[,3],
  `p.value` = summary(model_suspected)$coefficients[,4]
) %>%
  kbl(caption = "Regression Results: Total Suspected Persons",
      digits = 3) %>%
  kable_styling(bootstrap_options = c("striped", "hover"))

Supspicion_Model_nc
```
Table 3: ***Regression Results for Non-Citizen Suspicion Rates (Percentage of Non-Citizens)***

*Note:* The table details the regression model estimating the effect of the percentage of non-citizens on suspicion rates for non-citizens, excluding Bulgaria. The results highlight a statistically significant positive relationship.


```{r, echo=FALSE, fig.pos="H"}
suspected_analysis_data <- merged_data_final %>%
  select(country, year, percentage_nc_pop, convicted_p_nc)

ggplot(suspected_analysis_data, aes(x = percentage_nc_pop, y = convicted_p_nc, color = country)) +
  geom_point() +
  geom_smooth(method = "lm", formula = y ~ x, se = FALSE, color = "black", linetype = "dashed") +
  labs(
    title = "Relationship between the Percentage of Migrants and Percentage Migrants Convictions",
    x = "Percentage of Non-Citizens in Total Population",
    y = "Percentage of Non-citizens Convicted"
  ) +
  theme_minimal()+
  theme(
    legend.position = "none"
  )
```
Figure 10: ***Relationship between the Percentage of Migrants and Conviction Rates for Non-Citizens***

*Note:* This scatter plot examines the percentage of non-citizens convicted of crimes relative to the non-citizen population. The regression line suggests a weaker positive correlation compared to suspicion rates, indicating systemic factors influencing conviction rates beyond population proportions.


```{r, echo=FALSE, results='asis'}
model_convicted_nc <- lm(convicted_p_nc ~ percentage_nc_pop, 
                         data = merged_data_final)

Conviction_Model_nc <- data.frame(
  Term = c("Intercept", "% Non-Citizens"),
  Estimate = coef(model_convicted_nc),
  `Std.Error` = summary(model_convicted_nc)$coefficients[, 2],
  `t.value` = summary(model_convicted_nc)$coefficients[, 3],
  `p.value` = summary(model_convicted_nc)$coefficients[, 4]
) %>%
  kbl(
    caption = "Regression Results: Total Convicted Persons",
    digits = 3
  ) %>%
  kable_styling(bootstrap_options = c("striped", "hover"))

Conviction_Model_nc
```
Table 4: ***Regression Results for Non-Citizen Conviction Rates (Percentage of Non-Citizens)***

*Note:* The table summarizes the regression results for non-citizen conviction rates. The coefficients indicate the strength of the relationship between non-citizen proportions and conviction rates, with statistical significance levels included.


```{r, echo=FALSE, fig.pos="H"}
ggplot(merged_data_final, aes(x = dalton, y = total_convicted)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE) +
  labs(title = "Relationship Between Dalton and Total Convicted", 
       x = "Dalton Index", 
       y = "Total Convicted") +
  theme_minimal()
```
Figure 11: ***Relationship between Polarization (Dalton Index) and Total Convictions***

*Note:* This graph explores the impact of political polarization (measured by the Dalton Index) on total convictions. The regression line suggests a weak positive relationship, where higher polarization is associated with slightly higher conviction numbers.


```{r, echo=FALSE, results='asis'}
model_with_polynomial_convicted_total <- lm(total_convicted ~ dalton + poly(year, 2), data = merged_data_final)

Polynomial_Model_Convicted_Total <- data.frame(
  Term = c("Intercept", "Dalton Index", "Year (Polynomial Term 1)", "Year (Polynomial Term 2)"),
  Estimate = coef(model_with_polynomial_convicted_total),
  `Std.Error` = summary(model_with_polynomial_convicted_total)$coefficients[, 2],
  `t.value` = summary(model_with_polynomial_convicted_total)$coefficients[, 3],
  `p.value` = summary(model_with_polynomial_convicted_total)$coefficients[, 4]
) %>%
  kbl(
    caption = "Regression Results: Total Convicted (Polynomial Regression)",
    digits = 3
  ) %>%
  kable_styling(bootstrap_options = c("striped", "hover"))

Polynomial_Model_Convicted_Total
```
Table 5: ***Regression Results for Total Convictions (Dalton Index)***

*Note:* The table presents the polynomial regression results, including quadratic terms for the year. The Dalton Index shows a small but statistically significant association with total convictions.


```{r, echo=FALSE, fig.pos="H"}
ggplot(merged_data_final, aes(x = dalton, y = convicted_p_nc)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE) +
  labs(title = "Relationship Between Dalton and Percentage Migrants Conviction", 
       x = "Dalton Index", 
       y = "Percentage Convicted Migrants") +
  theme_minimal() +
   ylim(0, 5)
```
Figure 12: ***Relationship between Polarization and Percentage of Migrants Convicted***

*Note:* This graph examines the effect of political polarization on conviction rates for non-citizens. The regression line shows a weak positive association, suggesting that polarization might play a role in conviction outcomes for non-citizens.


```{r, echo=FALSE, results='asis'}
model_with_polynomial_convicted_nc <- lm(convicted_p_nc ~ dalton + poly(year, 2), data = merged_data_final)

Polynomial_Model_Convicted_NC <- data.frame(
  Term = c("Intercept", "Dalton Index", "Year (Polynomial Term 1)", "Year (Polynomial Term 2)"),
  Estimate = coef(model_with_polynomial_convicted_nc),
  `Std.Error` = summary(model_with_polynomial_convicted_nc)$coefficients[, 2],
  `t.value` = summary(model_with_polynomial_convicted_nc)$coefficients[, 3],
  `p.value` = summary(model_with_polynomial_convicted_nc)$coefficients[, 4]
) %>%
  kbl(
    caption = "Regression Results: Convicted Non-Citizens (Polynomial Regression)",
    digits = 3
  ) %>%
  kable_styling(bootstrap_options = c("striped", "hover"))

Polynomial_Model_Convicted_NC
```
Table 6: ***Regression Results for Non-Citizen Conviction Rates (Dalton Index)***

*Note:* This table summarizes the regression results for the relationship between the Dalton Index and conviction rates for non-citizens, highlighting the significance of polarization in shaping judicial outcomes.


```{r, echo=FALSE, fig.pos="H"}
ggplot(merged_data_final, aes(x = dalton, y = suspected_p_nc)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE) +
  labs(title = "Relationship Between Dalton and Percentage Migrants Suspicions", 
       x = "Dalton Index", 
       y = "Percentage Suspected Migrants") +
  theme_minimal() +
  ylim(0, 10)
```
Figure 13: ***Relationship between Polarization and Percentage of Migrants Suspected***

*Note:* This graph investigates the association between political polarization and suspicion rates for non-citizens. The positive trend in the regression line indicates that higher polarization correlates with increased suspicion rates for non-citizens.


```{r, echo=FALSE, results='asis'}
model_with_polynomial_suspected_nc <- lm(suspected_p_nc ~ dalton + poly(year, 2), data = merged_data_final)

Polynomial_Model_Suspected_NC <- data.frame(
  Term = c("Intercept", "Dalton Index", "Year (Polynomial Term 1)", "Year (Polynomial Term 2)"),
  Estimate = coef(model_with_polynomial_suspected_nc),
  `Std.Error` = summary(model_with_polynomial_suspected_nc)$coefficients[, 2],
  `t.value` = summary(model_with_polynomial_suspected_nc)$coefficients[, 3],
  `p.value` = summary(model_with_polynomial_suspected_nc)$coefficients[, 4]
) %>%
  kbl(
    caption = "Regression Results: Suspected Non-Citizens (Polynomial Regression)",
    digits = 3
  ) %>%
  kable_styling(bootstrap_options = c("striped", "hover"))

Polynomial_Model_Suspected_NC
```
Table 7: ***Regression Results for Non-Citizen Suspicion Rates (Dalton Index)***

*Note:* This table provides the polynomial regression results for the relationship between the Dalton Index and suspicion rates for non-citizens. The significant positive relationship suggests that polarization affects suspicion outcomes.


```{r, echo=FALSE, fig.pos="H"}
ggplot(merged_data_final, aes(x = right_ideology, y = total_convicted)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE) +
  labs(title = "Relationship Between Right Ideology and Total Conviction", 
       x = "Right Ideology", 
       y = "Total Convictions") +
  theme_minimal()
```
Figure 14: ***Relationship between Right Ideology and Total Convictions***

*Note:* This graph examines the influence of right-wing ideology on total convictions. The regression line shows a weak positive relationship, suggesting that stronger right-wing ideology is not a major driver of total convictions.


```{r, echo=FALSE, results='asis'}
model_with_ideology_convicted_total <- lm(total_convicted ~ right_ideology + year, data = merged_data_final)

Ideology_Model_Convicted_Total <- data.frame(
  Term = c("Intercept", "Right-Wing Ideology", "Year"),
  Estimate = coef(model_with_ideology_convicted_total),
  `Std.Error` = summary(model_with_ideology_convicted_total)$coefficients[, 2],
  `t.value` = summary(model_with_ideology_convicted_total)$coefficients[, 3],
  `p.value` = summary(model_with_ideology_convicted_total)$coefficients[, 4]
) %>%
  kbl(
    caption = "Regression Results: Total Convicted (Right-Wing Ideology)",
    digits = 3
  ) %>%
  kable_styling(bootstrap_options = c("striped", "hover"))

Ideology_Model_Convicted_Total

```
Table 8: ***Regression Results for Total Convictions (Right-Wing Ideology)***

*Note:* The table summarizes the regression results for total convictions, considering right-wing ideology and year as predictors. The results provide insight into the relationship between ideological trends and crime outcomes.


```{r, echo=FALSE, fig.pos="H"}
ggplot(merged_data_final, aes(x = right_ideology, y = convicted_p_nc)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE) +
  labs(title = "Relationship Between Right Ideology and Percentage of Migrants Convicted", 
       x = "Right Ideology", 
       y = "Non-citiznes Convictions") +
  theme_minimal() +
  ylim(0, 5)
```
Figure 15: ***Relationship between Right Ideology and Conviction Rates for Non-Citizens***

*Note:* This graph focuses on conviction rates for non-citizens and their relationship with right-wing ideology. The weak positive correlation implies a limited influence of ideology on conviction outcomes.


```{r, echo=FALSE, results='asis'}
model_with_ideology_convicted_nc <- lm(convicted_p_nc ~ right_ideology + year, data = merged_data_final)

Ideology_Model_Convicted_NC <- data.frame(
  Term = c("Intercept", "Right-Wing Ideology", "Year"),
  Estimate = coef(model_with_ideology_convicted_nc),
  `Std.Error` = summary(model_with_ideology_convicted_nc)$coefficients[, 2],
  `t.value` = summary(model_with_ideology_convicted_nc)$coefficients[, 3],
  `p.value` = summary(model_with_ideology_convicted_nc)$coefficients[, 4]
) %>%
  kbl(
    caption = "Regression Results: Convicted Non-Citizens (Right-Wing Ideology)",
    digits = 3
  ) %>%
  kable_styling(bootstrap_options = c("striped", "hover"))

Ideology_Model_Convicted_NC

```
Table 9: ***Regression Results for Non-Citizen Conviction Rates (Right-Wing Ideology)***

*Note:* This table provides regression results for the relationship between right-wing ideology and non-citizen conviction rates. The coefficients highlight whether ideological trends significantly affect judicial outcomes.


```{r, echo=FALSE, fig.pos="H"}
ggplot(merged_data_final, aes(x = right_ideology, y = suspected_p_nc)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE) +
  labs(title = "Relationship Between Right Ideology and Percentage of Migrants Suspected", 
       x = "Right Ideology", 
       y = "Non-citiznes Suspicons") +
  theme_minimal() +
  ylim(0, 5)
```
Figure 16: ***Relationship between Right Ideology and Suspicion Rates for Non-Citizens***

*Note:* This graph investigates the relationship between right-wing ideology and suspicion rates for non-citizens. The regression line indicates a stronger positive correlation, suggesting that suspicion rates are more sensitive to ideological shifts.


```{r, echo=FALSE, results='asis'}
model_with_ideology_suspected_nc <- lm(suspected_p_nc ~ right_ideology + year, data = merged_data_final)

Ideology_Model_Suspected_NC <- data.frame(
  Term = c("Intercept", "Right-Wing Ideology", "Year"),
  Estimate = coef(model_with_ideology_suspected_nc),
  `Std.Error` = summary(model_with_ideology_suspected_nc)$coefficients[, 2],
  `t.value` = summary(model_with_ideology_suspected_nc)$coefficients[, 3],
  `p.value` = summary(model_with_ideology_suspected_nc)$coefficients[, 4]
) %>%
  kbl(
    caption = "Regression Results: Suspected Non-Citizens (Right-Wing Ideology)",
    digits = 3
  ) %>%
  kable_styling(bootstrap_options = c("striped", "hover"))

Ideology_Model_Suspected_NC
```
Table 10: ***Regression Results for Non-Citizen Suspicion Rates (Right-Wing Ideology)***

*Note:* This table summarizes the regression results for the relationship between right-wing ideology and suspicion rates for non-citizens, showing significant associations.
